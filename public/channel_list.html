<!DOCTYPE html>
<!--[if IE 8]> <html lang="ja" class="ie8"> <![endif]-->
<!--[if IE 9]> <html lang="ja" class="ie9"> <![endif]-->
<!--[if !IE]><!--> <html lang="ja"> <!--<![endif]-->
<!-- BEGIN HEAD -->
<head>
	<meta charset="utf-8" />
	<title>更新分类</title>
	<meta content="width=device-width, initial-scale=1.0" name="viewport" />
	<meta content="" name="description" />
	<meta content="" name="author" />
	<!-- BEGIN GLOBAL MANDATORY STYLES -->
	<link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
	<link href="assets/plugins/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"/>
	<link href="assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
	<link href="assets/css/style-metro.css" rel="stylesheet" type="text/css"/>
	<link href="assets/css/style.css" rel="stylesheet" type="text/css"/>
	<link href="assets/css/style-responsive.css" rel="stylesheet" type="text/css"/>
	<link href="assets/css/themes/brown.css" rel="stylesheet" type="text/css" id="style_color"/>
	<link href="assets/plugins/uniform/css/uniform.default.css" rel="stylesheet" type="text/css"/>
	<!-- BEGIN PAGE LEVEL STYLES -->
	<link rel="stylesheet" type="text/css" href="assets/plugins/select2/select2_metro.css" />
	<link rel="stylesheet" href="assets/plugins/data-tables/DT_bootstrap.css" />
	<!-- END PAGE LEVEL STYLES -->
	<!-- END GLOBAL MANDATORY STYLES -->
	<link rel="shortcut icon" href="favicon.ico" />
</head>
<!-- END HEAD -->
<!-- BEGIN BODY -->
<body class="page-header-fixed page-footer-fixed page-sidebar-fixed">
	<!-- BEGIN HEADER -->   
	<div class="header navbar navbar-inverse navbar-fixed-top">
		<!-- BEGIN TOP NAVIGATION BAR -->
		<div class="navbar-inner">
			<div class="container-fluid">
				<!-- BEGIN LOGO -->
				<a class="brand" href="index.html">
				<img src="assets/img/logo.png" alt="logo" />
				</a>
				<!-- END LOGO -->
				<!-- BEGIN RESPONSIVE MENU TOGGLER -->
				<a href="javascript:;" class="btn-navbar collapsed" data-toggle="collapse" data-target=".nav-collapse">
				<img src="assets/img/menu-toggler.png" alt="" />
				</a>          
				<!-- END RESPONSIVE MENU TOGGLER -->            
				<!-- BEGIN TOP NAVIGATION MENU -->              
				<ul class="nav pull-right">
					
					<!-- BEGIN LANGUAGE DROPDOWN -->
				
					<!-- END LANGUAGE DROPDOWN -->
					<!-- BEGIN USER LOGIN DROPDOWN -->
					<li class="dropdown user">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
                            <img id="img" alt="" src="assets/img/mockup/no-image.png" width="29" height="29" />
                            <span id="titlename" class="username"><lable id="textname>&nbsp</lable>"</span>
                            
						</a>
						
					</li>
					<!-- END USER LOGIN DROPDOWN -->
				</ul>
				<!-- END TOP NAVIGATION MENU --> 
			</div>
		</div>
		<!-- END TOP NAVIGATION BAR -->
	</div>
	<!-- END HEADER -->
	<!-- BEGIN CONTAINER -->   
	<div class="page-container row-fluid">
		<!-- BEGIN SIDEBAR -->
		<div class="page-sidebar nav-collapse collapse">
			<!-- BEGIN SIDEBAR MENU -->
			<ul class="page-sidebar-menu">
				<li>
					<!-- BEGIN SIDEBAR TOGGLER BUTTON -->
					<div class="sidebar-toggler hidden-phone"></div>
					<!-- BEGIN SIDEBAR TOGGLER BUTTON -->
				</li>
				<form class="sidebar-search">
						
					</form>
				<li >
                    <a href="startup_list.html">
                        <i class="icon-cogs"></i>
                        <span class="title">开机画面</span>
                       
					</a>
				</li>
				<li class="active">
                    <a href="channel_list.html">
                        <i class="icon-sitemap"></i>
                        <span class="title">频道类别</span>
                         <span class="selected"></span>
					</a>
				</li>
			
				<li >
                    <a href="video_list.html">
                        <i class="icon-bookmark-empty"></i>
                        <span class="title">视频管理</span>
					</a>
				</li>
				
				<li >
                    <a href="user_list.html">
                        <i class="icon-briefcase"></i>
                        <span class="title">用户管理</span>
					</a>
				</li>
			</ul>
			<!-- END SIDEBAR MENU -->
		</div>
		<!-- END SIDEBAR -->
		<!-- BEGIN PAGE -->
		<div class="page-content">
			<!-- BEGIN PAGE CONTAINER-->
			<div class="container-fluid">
				<!-- BEGIN PAGE HEADER-->
				<div class="row-fluid">
					<div class="span12">
					
						<!-- BEGIN PAGE TITLE & BREADCRUMB-->
						<h3 class="page-title">
							管理者 <small>更新分类</small>
						</h3>
						
							
							<ul class="breadcrumb">
							<li>
								<i class="icon-home"></i>
							 管理者</li>
						</ul>
						
						<!-- END PAGE TITLE & BREADCRUMB-->
					</div>
				</div>
				<!-- END PAGE HEADER-->
				<!-- BEGIN PAGE CONTENT-->
				<div class="row-fluid">
					<div class="span12">
						<!-- BEGIN VALIDATION STATES-->
						<div class="portlet box green">
							<div class="portlet-title">
								<div class="caption"><i class="icon-reorder"></i>更新分类</div>
							</div>
							<div class="form-actions" style="margin: auto; clear: both;">
                                    <a href="channel_add.html" class="btn yellow">新增内容</a>
                                </div>
							<div class="portlet-body form">
								
								  	<div class="portlet-body form">
								<form action="" id="add_form" class="form-horizontal" method="post">
									<div class="control-group">
										<table class="table table-striped table-hover table-bordered" id="sample_editable_1" align="center" valign="middle" >
											<thead>
												<tr>
													<th>ID</th>
													<th>分类</th>
													<th>iPhone 图片</th>
													<th>iPad 图片</th>
													<th>视频</th>
													<th style="width: 180px;">操作</th>
												</tr>
											</thead>
											<tbody>
											</tbody>
										</table>
										<!--  page start  -->
                                        <div class="row-fluid">
                                            <div class="span6">
                                                <div class="dataTables_info" id="sample_editable_1_info"></div>
                                                <input type="hidden" id="nowPage" value="1">
                                                <input type="hidden" id="count" value="0">
                                            </div>
                                            <div class="span6">
                                                <div class="dataTables_paginate paging_bootstrap pagination">
                                                    <ul>
                                                        <li class="prev disabled">
                                                            <a id="pagePrev" href="#">← <span class="hidden-480">Prev</span></a>
                                                        </li>
                                                        <li class="next">
                                                            <a id="pageNext" href="#"><span class="hidden-480">Next</span> → </a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <!--  page end  -->
									</div>
								  </table>                  
								</form>
								<!-- END FORM-->
							</div>
						</div>
						<!-- END VALIDATION STATES-->
					</div>
				</div>
				<!-- END PAGE CONTENT-->
			</div>
			<!-- END PAGE CONTAINER--> 
		</div>
		<!-- END PAGE -->    
	</div>
	<!-- END CONTAINER -->
	<!-- BEGIN FOOTER -->
	<div class="footer">
		<div class="footer-inner">
			2014 &copy; amazine by mikosoft.
		</div>
		<div class="footer-tools">
			<span class="go-top">
			<i class="icon-angle-up"></i>
			</span>
		</div>
	</div>
	<!-- END FOOTER -->
	<!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->
	<!-- BEGIN CORE PLUGINS -->   <script src="assets/plugins/jquery-1.10.1.min.js" type="text/javascript"></script>
	<script src="assets/plugins/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>
	<!-- IMPORTANT! Load jquery-ui-1.10.1.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->
	<script src="assets/plugins/jquery-ui/jquery-ui-1.10.1.custom.min.js" type="text/javascript"></script>
	<script src="assets/plugins/jquery-pjax/jquery.pjax.js" type="text/javascript"></script>
	<script src="assets/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
	<script src="assets/plugins/bootstrap-hover-dropdown/twitter-bootstrap-hover-dropdown.min.js" type="text/javascript" ></script>
	<!--[if lt IE 9]>
	<script src="assets/plugins/excanvas.min.js"></script>
	<script src="assets/plugins/respond.min.js"></script>  
	<![endif]-->   
	<script src="assets/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
	<script src="assets/plugins/jquery.blockui.min.js" type="text/javascript"></script>  
	<script src="assets/plugins/jquery.cookie.min.js" type="text/javascript"></script>
	<script src="assets/plugins/uniform/jquery.uniform.min.js" type="text/javascript" ></script>
	<!-- END CORE PLUGINS -->
	<!-- BEGIN PAGE LEVEL PLUGINS -->
	<script type="text/javascript" src="assets/plugins/select2/select2.min.js"></script>
	<script type="text/javascript" src="assets/plugins/data-tables/jquery.dataTables.js"></script>
	<script type="text/javascript" src="assets/plugins/data-tables/DT_bootstrap.js"></script>
	<!-- END PAGE LEVEL PLUGINS -->
	<script src="assets/scripts/app.js"></script>
	<script src="assets/scripts/page/table-editable.js"></script>
	<script src="https://cn.avoscloud.com/scripts/lib/av-0.4.1.min.js"></script>
	<script>
		jQuery(document).ready(function() {    
			App.init();
			App.setAssetsPath('assets');
			TableEditable.init("channel","channel_edit.html",5); 
		   
		   
		    AV.initialize("y8cwz5xanjtclwys0cm6ucb07vrccr8oedicxznhcr9zwbwd", "bkzhoupdt3mjaze7y9kphdmguyxfjbp5nib9rmjtneyuwrk5");
			function getData(count)
			{
				var chandleObj = AV.Object.extend("channel");
				var query = new AV.Query(chandleObj);
	            

	            var nowPageNum = $('#nowPage').attr('value');
                var maxPageNum = Math.ceil(count/10);
                $('#sample_editable_1_info').empty();

                if(nowPageNum==1){
                    query.skip(0);
                    query.limit(10);
                    var scount = 0;
                    var ecount = 10;
                    
                    if(count > 0) scount = 1;
                    if(count < 10)ecount = count;
                    
                    $('#sample_editable_1_info').append(count+" 条中 第" + scount + " 条 〜 第" + ecount + " 条");
                }else if(nowPageNum>=2 && nowPageNum<=(maxPageNum-1)){
                    var pageNum=(nowPageNum-1)*10;
                    query.skip(pageNum);
                    query.limit(10);
                    $('#sample_editable_1_info').append(count+" 条中 第" + (pageNum+1) + " 条 〜 第" + (nowPageNum*10) + " 条");
                }else if(nowPageNum==maxPageNum){
                    var pageNum=(nowPageNum-1)*10;
                    query.skip(pageNum);
                    query.limit(count-pageNum);
                    $('#sample_editable_1_info').append(count+" 条中 第" + (pageNum+1) + " 条 〜 第" + count + " 条");
                }
				
				query.find({
				  success: function(results) {
					$("#add_form tbody").html("");
					var oTable = $('#sample_editable_1').dataTable();
					oTable.fnClearTable();
					for (var i = 0; i < results.length; i++) {
						var object = results[i];

						var name = object.get("name");
						if(!name){
							name = " ";
						}
						var imageObj_iphone = object.get('image_iphone');
						var image_iphone =" ";
						if(imageObj_iphone){
							image_iphone = imageObj_iphone.thumbnailURL(100, 100);						
						}
						var imageObj_ipad = object.get('image_ipad');
						var image_ipad =" ";
						if(imageObj_ipad){
							image_ipad = imageObj_ipad.thumbnailURL(100, 100);						
						}
						var videoObj = object.get('video');
						var video =" ";
						if(videoObj){
							video = videoObj.url();						
						}
						
						oTable.fnAddData([object.id, name, "<img name='image' height='100px' width='100px' src='" + image_iphone + "'/>", "<img name='image' height='100px' width='100px' src='" + image_ipad + "'/>","<video width='180px' height='180px' controls='controls'><source src='" + video + "' type='video/mp4'></video>",
							"<a href='javascript:;' class='btn yellow mini edit'><i class='icon-pencil'></i> Edit</a>" + "<a>&nbsp;</a>" +
							"<a href='javascript:;' class='btn red mini delete'><i class='icon-trash'></i> Delete</a>"
						]);
					}
				  },
				  error: function(error) {
					alert("Error: " + error.code + " " + error.message);
				  }
				});
			}
			
            var vobj = AV.Object.extend("channel");
            var vquery = new AV.Query(vobj);
		 	vquery.count({
			  success: function(count) {
			    getData(count);
			    if(count<=10){
			    	$('.next').addClass('disabled');
			    }
                $('#count').attr('value',count);
			  },
			  error: function(error) {
			    
			  }
			});

			$('#pagePrev').click(function(){
                var num=$('#nowPage').attr('value');
                var count = $('#count').attr('value');
                var maxnum = Math.ceil(count/10);
                if(num>1){
                    num--;
                    $('#nowPage').attr('value',num);
                    if(num==1){
                        $('.next').removeClass('disabled');
                        $('.prev').addClass('disabled');
                    }else if(num>1 && num<maxnum){
                        $('.prev').removeClass('disabled');
                        $('.next').removeClass('disabled');
                    }else if(num==maxnum){
                        $('.prev').removeClass('disabled');
                        $('.next').addClass('disabled');
                    }
                    getData(count);
                }
                
            });
            $('#pageNext').click(function(){
                var num=$('#nowPage').attr('value');
                var count = $('#count').attr('value');
                var maxnum = Math.ceil(count/10);
                if(num<maxnum){
                    num++;
                    $('#nowPage').attr('value',num);
                    if(num==1){
                        $('.next').removeClass('disabled');
                        $('.prev').addClass('disabled');
                    }else if(num>1 && num<maxnum){
                        $('.prev').removeClass('disabled');
                        $('.next').removeClass('disabled');
                    }else if(num==maxnum){
                        $('.prev').removeClass('disabled');
                        $('.next').addClass('disabled');
                    }
                    getData(count);
                }
            });
           
		});
	</script>
	<!-- END JAVASCRIPTS -->
</body>
<!-- END BODY -->
</html>